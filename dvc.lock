schema: '2.0'
stages:
  preprocess:
    cmd: python src/convert_brats_slices.py
    deps:
    - path: raw_data
      hash: md5
      md5: c5c4bf5c732fa4e6e758c7969718ac52.dir
      size: 13389537553
      nfiles: 6255
    - path: src/convert_brats_slices.py
      hash: md5
      md5: 21736c2ddb676f1985a2b2e00dd6352f
      size: 6371
    outs:
    - path: logs
      hash: md5
      md5: fb327801bd2238d7e2a2fd4bbdcd2502.dir
      size: 203556
      nfiles: 1
    - path: processed_data
      hash: md5
      md5: 3517a7e07d8576a843ed4d36dfd2ded4.dir
      size: 47801008640
      nfiles: 127630
  train:
    cmd: PYTHONPATH=. python3.11 src/Model_seg.py
    deps:
    - path: params.yaml
      hash: md5
      md5: 93045efc2b82e46e211ec409e47a0b57
      size: 155
      isexec: true
    - path: processed_data/
      hash: md5
      md5: a03e99984c8adc5b93006efa69602de1.dir
      size: 7056415744
      nfiles: 12248
    - path: src/Model_seg.py
      hash: md5
      md5: bb8817eb1acf9261a0f869a6dc32f0f0
      size: 6036
      isexec: true
    - path: src/data.py
      hash: md5
      md5: 850b68cc316cc4f9d057e89fe3fe4216
      size: 3678
      isexec: true
    - path: src/losses.py
      hash: md5
      md5: 6a1876e92f631639423cdec67a80dc3b
      size: 7909
      isexec: true
    params:
      params.yaml:
        model_seg:
          IMG_SIZE:
          - 128
          - 128
          INPUT_CHANNELS: 4
          NUM_CLASSES: 4
          LEARNING_RATE: 0.0001
          EPOCHS: 60
          BATCH_SIZE: 4
    outs:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 9fe10e31be1d8051e407ddfbd2fd815a
      size: 23710160
      isexec: true
  evaluate:
    cmd: PYTHONPATH=. python3.11 src/model_evaluation.py
    deps:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 9fe10e31be1d8051e407ddfbd2fd815a
      size: 23710160
      isexec: true
    - path: processed_data/
      hash: md5
      md5: a03e99984c8adc5b93006efa69602de1.dir
      size: 7056415744
      nfiles: 12248
    - path: src/data.py
      hash: md5
      md5: 850b68cc316cc4f9d057e89fe3fe4216
      size: 3678
      isexec: true
    - path: src/losses.py
      hash: md5
      md5: 6a1876e92f631639423cdec67a80dc3b
      size: 7909
      isexec: true
    - path: src/model_evaluation.py
      hash: md5
      md5: 9f90108f6b3677e8c85657debac4e97a
      size: 2787
      isexec: true
    outs:
    - path: test_metrics.json
      hash: md5
      md5: 0c7a21991916c07724847d215f867e50
      size: 138
      isexec: true
  inference:
    cmd: PYTHONPATH=. python3.11 src/predict_and_stack.py
    deps:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 9fe10e31be1d8051e407ddfbd2fd815a
      size: 23710160
      isexec: true
    - path: processed_data/Test_data/
      hash: md5
      md5: 57a0822e5e07bd8a9a3302d50ee24323.dir
      size: 738596096
      nfiles: 1282
    - path: src/predict_and_stack.py
      hash: md5
      md5: baa636acc7ee93a54380be4c342f775c
      size: 5515
      isexec: true
    outs:
    - path: predictions_3d/
      hash: md5
      md5: 72c339c2fc58323a23ee3adcbb782de6.dir
      size: 252054016
      nfiles: 20
  export_nifti:
    cmd: python3.11 src/export_nifti.py
    deps:
    - path: predictions_3d/
      hash: md5
      md5: 72c339c2fc58323a23ee3adcbb782de6.dir
      size: 252054016
      nfiles: 20
    - path: src/export_nifti.py
      hash: md5
      md5: 0158b9ae68379c05540ef740059ccc9f
      size: 931
      isexec: true
    outs:
    - path: nifti_outputs/
      hash: md5
      md5: 340e8cabf4ab6409009ce6d7cff1065d.dir
      size: 669736
      nfiles: 20
  visualize:
    cmd: python3.11 src/render_3d.py
    deps:
    - path: predictions_3d/
      hash: md5
      md5: 72c339c2fc58323a23ee3adcbb782de6.dir
      size: 252054016
      nfiles: 20
    - path: src/render_3d.py
      hash: md5
      md5: 9bc8501060f2327d21eeb9e96d1c1171
      size: 4137
      isexec: true
    params:
      params.yaml:
        model_seg.IMG_SIZE:
        - 128
        - 128
    outs:
    - path: visualizations/
      hash: md5
      md5: d9e741f969086c10d7bb1bf7737c30ec.dir
      size: 706119
      nfiles: 50
