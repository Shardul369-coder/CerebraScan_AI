schema: '2.0'
stages:
  preprocess:
    cmd: python src/convert_brats_slices.py
    deps:
    - path: raw_data
      hash: md5
      md5: c5c4bf5c732fa4e6e758c7969718ac52.dir
      size: 13389537553
      nfiles: 6255
    - path: src/convert_brats_slices.py
      hash: md5
      md5: 21736c2ddb676f1985a2b2e00dd6352f
      size: 6371
    outs:
    - path: logs
      hash: md5
      md5: fb327801bd2238d7e2a2fd4bbdcd2502.dir
      size: 203556
      nfiles: 1
    - path: processed_data
      hash: md5
      md5: 3517a7e07d8576a843ed4d36dfd2ded4.dir
      size: 47801008640
      nfiles: 127630
  train:
    cmd: PYTHONPATH=. python3.11 src/Model_seg.py
    deps:
    - path: params.yaml
      hash: md5
      md5: 781549fe8fb88b520dbe624a6d720832
      size: 312
      isexec: true
    - path: processed_data/
      hash: md5
      md5: a807e2ba557b2dccd22bc355f196f122.dir
      size: 74010555136
      nfiles: 128462
    - path: src/Model_seg.py
      hash: md5
      md5: 93f20076168e4bc6c97c21c61a7b903e
      size: 5252
      isexec: true
    - path: src/data.py
      hash: md5
      md5: 620de3251f75b48748027f7a21c9de57
      size: 3716
      isexec: true
    - path: src/losses.py
      hash: md5
      md5: 79a1fbb77a9260ec77f167e832ff9d18
      size: 4804
      isexec: true
    params:
      params.yaml:
        model_seg:
          IMG_SIZE:
          - 240
          - 240
          INPUT_CHANNELS: 4
          NUM_CLASSES: 4
          LEARNING_RATE: 0.0001
          EPOCHS: 50
          BATCH_SIZE: 1
    outs:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 3abd777ea57c68d13bf7a6f25d9e710d
      size: 23710208
      isexec: true
  evaluate:
    cmd: PYTHONPATH=. python3.11 src/model_evaluation.py
    deps:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 3abd777ea57c68d13bf7a6f25d9e710d
      size: 23710208
      isexec: true
    - path: processed_data/
      hash: md5
      md5: a807e2ba557b2dccd22bc355f196f122.dir
      size: 74010555136
      nfiles: 128462
    - path: src/data.py
      hash: md5
      md5: 620de3251f75b48748027f7a21c9de57
      size: 3716
      isexec: true
    - path: src/losses.py
      hash: md5
      md5: 79a1fbb77a9260ec77f167e832ff9d18
      size: 4804
      isexec: true
    - path: src/model_evaluation.py
      hash: md5
      md5: 92daee3238945349b96bcffd4a9c47ef
      size: 2291
      isexec: true
    outs:
    - path: test_metrics.json
      hash: md5
      md5: 94f5934d5e84e95906c7086a8d2130b1
      size: 86
      isexec: true
  inference:
    cmd: PYTHONPATH=. python3.11 src/predict_and_stack.py
    deps:
    - path: checkpoints/seg_best.h5
      hash: md5
      md5: 3abd777ea57c68d13bf7a6f25d9e710d
      size: 23710208
      isexec: true
    - path: processed_data/Test_data/
      hash: md5
      md5: 62b66507bd317352b53c73d233a59223.dir
      size: 7217731584
      nfiles: 12528
    - path: src/predict_and_stack.py
      hash: md5
      md5: 0ca886b34e4682dcd4ec51393a816ea3
      size: 5391
      isexec: true
    outs:
    - path: predictions_3d/
      hash: md5
      md5: 80501f33d9ab4489ba569d546675762d.dir
      size: 8659379200
      nfiles: 200
  export_nifti:
    cmd: python3.11 src/export_nifti.py
    deps:
    - path: predictions_3d/
      hash: md5
      md5: 80501f33d9ab4489ba569d546675762d.dir
      size: 8659379200
      nfiles: 200
    - path: src/export_nifti.py
      hash: md5
      md5: 0158b9ae68379c05540ef740059ccc9f
      size: 931
      isexec: true
    outs:
    - path: nifti_outputs/
      hash: md5
      md5: c4358346b56bbbeab21eb72f44e4beff.dir
      size: 7890995
      nfiles: 200
  visualize:
    cmd: python3.11 src/render_3d.py
    deps:
    - path: predictions_3d/
      hash: md5
      md5: 80501f33d9ab4489ba569d546675762d.dir
      size: 8659379200
      nfiles: 200
    - path: src/render_3d.py
      hash: md5
      md5: 63a613f0afe4e19a061bde2715f0f06e
      size: 5299
      isexec: true
    params:
      params.yaml:
        model_seg.IMG_SIZE:
        - 240
        - 240
    outs:
    - path: visualizations/
      hash: md5
      md5: 3d19e9eabd707c44e1512c10251ee10f.dir
      size: 49435387
      nfiles: 1340
